(()=>{function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}window.jQuery(document).ready(function(l){function c(t,o){t.prop("disabled",!o),o?t.removeClass("is-loading"):t.addClass("is-loading")}function u(t){var o=1==l("#tutor_gc_bulk_action_button").data("process_running");return t||(f=[]),l("#tutor_gc_bulk_action_button").text(t?"Abort":"Apply").data("process_running",t),o}function d(t){var o={title:(o=window.wp.i18n.__)("Do you want to import students from this Classroom?","tutor-pro"),description:o("This is not recommended for paid courses as importing will skip the payment procedure.","tutor-pro"),buttons:{cancel:{title:o("Cancel","tutor-pro"),id:"cancel",class:"tutor-btn tutor-btn-outline-primary",callback:function(){e.remove(),l("body").removeClass("tutor-modal-open")}},reset:{title:o("Yes, Import Student","tutor-pro"),id:"reset",class:"tutor-btn tutor-btn-primary tutor-ml-20",callback:function(){e.remove(),l("body").removeClass("tutor-modal-open"),_="import",t()}}}},e=new window.tutor_popup(l,"import-icon").popup(o)}function p(t){var o={title:(o=window.wp.i18n.__)("Do you want to remove this course from the system?","tutor-pro"),description:o("This will not delete it from Google Classroom, it will only remove the connection.","tutor-pro"),buttons:{cancel:{title:o("Cancel","tutor-pro"),id:"cancel",class:"tutor-btn tutor-btn-outline-primary",callback:function(){e.remove(),l("body").removeClass("tutor-modal-open")}},reset:{title:o("Yes, Delete Course","tutor-pro"),id:"reset",class:"tutor-btn tutor-btn-primary tutor-ml-20",callback:function(){e.remove(),l("body").removeClass("tutor-modal-open"),t()}}}},e=new window.tutor_popup(l,"icon-trash").popup(o)}function o(){window.location.reload()}(new function(){this.upload_area=l("#tutor_gc_dashboard .tutor-upload-area"),this.input_field=this.upload_area.find('[type="file"]'),this.load_button=l("#tutor_gc_credential_upload>button"),this.uploaded_file=null,this.is_file_valid=null,this.init=function(){this.on_click(),this.on_change(),this.on_drop(),this.on_save()},this.load_file=function(t){t&&t[0]&&(t=t[0],this.is_file_valid=this.is_valid_file(t),this.load_button.prop("disabled",!this.is_file_valid),this.is_file_valid?(this.uploaded_file=t,this.upload_area.find("span.file_name").remove(),this.upload_area.append('<span class="file_name">'+this.uploaded_file.name+"</span>")):alert("Invalid File."))},this.is_valid_file=function(t){return"application/json"==(t.type||"").toLowerCase()},this.on_click=function(){var o=this;this.upload_area.find("button").click(function(t){t.preventDefault(),o.input_field.trigger("click")})},this.on_change=function(){var o=this;this.input_field.change(function(t){o.load_file(t.currentTarget.files),l(this).val("")})},this.on_drop=function(){var o=this;this.upload_area.on("drag dragstart dragend dragover dragenter dragleave drop",function(t){t.preventDefault(),t.stopPropagation()}).on("dragover dragenter",function(){l(this).addClass("dragover")}).on("dragleave dragend drop",function(){l(this).removeClass("dragover")}).on("drop",function(t){o.load_file(t.originalEvent.dataTransfer.files)})},this.on_save=function(){var a=this;this.load_button.click(function(){var t,o,e;a.is_file_valid&&(t=l(this),(o=new FormData).append("credential",a.uploaded_file,a.uploaded_file.name),o.append("action","tutor_gc_credential_save"),e=tutor_get_nonce_data(!0),o.append(e.key,e.value),c(t,!1),l.ajax({url:window._tutorobject.ajaxurl,type:"POST",processData:!1,contentType:!1,data:o,success:function(){window.location.reload()},error:function(){c(t,!0),alert("Request Failed.")}}))})}}).init();var t=l("#tutor_gc_dashboard .google-classroom-class-list"),_="no",f=[];t.find("[data-action]").not("a").click(function(t){var e=l(this),a="primary",o=e.data("classroom_id"),i=e.data("class_post_id"),n=e.data("action"),r=function(t){alert("Something Went Wrong!"),c(e,!0)};function s(){c(e,!1),l.ajax({url:window._tutorobject.ajaxurl,data:{class_id:o,action:"tutor_gc_class_action",action_name:n,post_id:i,enroll_student:_},type:"POST",success:function(t){try{t=JSON.parse(t)}catch(t){}if("object"!==h(t))r();else{switch(t.class_status){case"publish":a="success";break;case"draft":a="warning";break;case"trash":a="danger";break;default:a="primary"}var o=e.parent().attr("class","class-status-"+t.class_status);t.edit_link&&o.find(".class-edit-link").attr("href",t.edit_link),t.preview_link&&o.find(".class-preview-link").attr("href",t.preview_link),t.post_id&&o.find("[data-action]").attr("data-class_post_id",t.post_id),o.parent().find("[data-gc-status]").attr("class","tutor-badge-label label-"+a).text(t.status_text),c(e,!0),0<f.length?f.shift().trigger("click"):u(!1)}},error:r})}"delete"==n&&t.originalEvent?p(s):"import"===n&&t.originalEvent?d(s):s()}),l("#tutor_gc_classroom_code_privilege").change(function(){var t=l(this).prop("checked")?"yes":"no";l.ajax({url:window._tutorobject.ajaxurl,data:{action:"tutor_gc_classroom_code_privilege",enabled:t},type:"POST",error:function(){alert("Action Failed.")}})}),l("#tutor_gc_bulk_action_button").click(function(){var o,e;function t(){f=e.slice(1),u(!0),e[0].trigger("click")}1!=u(!1)&&(o=l(this).prev().val(),e=[],l(".google-classroom-class-list .tutor-bulk-checkbox:checked").each(function(){var t=l(this).closest("tr").find('[data-action="'+o+'"]:visible');0<t.length&&e.push(t.eq(0))}),e.length?"import"==o?d(t):"delete"==o?p(t):t():alert("Please select the correct option to take an action."))}),l("#tutor_gc_dashboard").on("input","#tutor-gc-search-class",function(){var t=l(".google-classroom-class-list>tbody"),e=l(this).val()||"";""==(e=e.trim())?t.children().show():t.children().each(function(){var t=l(this).children(),o=t.filter(".tutor-gc-title").text().toLowerCase().trim(),t=t.filter(".tutor-gc-code").text().toLowerCase().trim(),o=-1<o.indexOf(e.toLowerCase())||t==e;l(this)[o?"show":"hide"]()})});l("#tutor_gc_credential_upgrade").click(function(t){t.preventDefault();t=l(this).data("message");t&&!confirm(t)||(c(l(this),!1),l.ajax({url:window._tutorobject.ajaxurl,data:{action:"tutor_gc_credential_upgrade"},type:"POST",success:o,error:o}))})})})();